---
title: "Comparison to Fohlmeister data"
author: "Janica Bühler"
date: "28 7 2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
# This is the R plotting skript to compare the SISAL1k data to Fohlmeister2020 data:
library(plyr)
library(dplyr)
library(tidyverse)
```

Read in data:
```{r}
Fohlmeister <- read.csv("../../07_R_Code/202009_SISAL1k/Data/Fohlmeister2020.csv", stringsAsFactors=FALSE)
Fohlmeister$d13C = c(3.38,3.49,-10.37,-4.61,-4.89,-6.16,-9.63,-9.31,-8.83,-5.86,-6.34,-7.84,-6.09,-7.12,-7.41,-10.70,-10.16,-9.50,-5.32,-9.23,-9.37,-12.08,-7.93,-11.92,-6.20,-8.16,-2.54,-6.25,-4.18,-9.90,-11.02,-7.25,-5.72,-4.29,-7.71,-11.04,-6.56,-11.40,-8.97,-5.53,-9.59,-5.15,-6.44,0.24,-9.57,-10.17,-3.60,-11.09,-11.71,1.38,-11.16,-11.89,-10.81,-9.06,-8.56,-2.59,-4.74,-9.86,-10.52)

ENTITY_INFO <- read.csv("../../07_R_Code/202009_SISAL1k/Data/SISAL1k_entity_info.csv", stringsAsFactors=FALSE)
MODELS = list()
MODELS$HADCM3_DS <- read.csv("../../07_R_Code/202009_SISAL1k/Data/SISAL1k_ds_HadCM3.csv", stringsAsFactors=FALSE)
MODELS$ECHAM5_DS <- read.csv("../../07_R_Code/202009_SISAL1k/Data/SISAL1k_ds_ECHAM5.csv", stringsAsFactors=FALSE)
MODELS$isoGSM_DS <- read.csv("../../07_R_Code/202009_SISAL1k/Data/SISAL1k_ds_isoGSM.csv", stringsAsFactors=FALSE)
MODELS$GISS_DS <- read.csv("../../07_R_Code/202009_SISAL1k/Data/SISAL1k_ds_GISS.csv", stringsAsFactors=FALSE)
MODELS$CESM_DS <- read.csv("../../07_R_Code/202009_SISAL1k/Data/SISAL1k_ds_CESM.csv", stringsAsFactors=FALSE)

scatter_data = array(dim = c(length(ENTITY_INFO$entity_id),8))
colnames(scatter_data) = c("entity_id", "site_id", "d18O", "d13C","altitude", "TEMP", "PREC", "EVAP")

scatter_data[,1] = ENTITY_INFO$entity_id
scatter_data[,2] = ENTITY_INFO$site_id
scatter_data[,5] = ENTITY_INFO$elevation
for(ii in 1:length(ENTITY_INFO$entity_id)){
  entity = ENTITY_INFO$entity_id[ii]
  data_rec_1 = MODELS[[1]] %>% filter(entity_id == entity)
  data_rec_2 = MODELS[[2]] %>% filter(entity_id == entity)
  data_rec_3 = MODELS[[3]] %>% filter(entity_id == entity)
  data_rec_4 = MODELS[[4]] %>% filter(entity_id == entity)
  data_rec_5 = MODELS[[5]] %>% filter(entity_id == entity)
  scatter_data[ii,3] = mean(data_rec_1$d18O_measurement, na.rm = T)
  scatter_data[ii,4] = mean(data_rec_1$d13C_measurement, na.rm = T)
  scatter_data[ii,6] = mean(c(data_rec_1$TEMP,data_rec_2$TEMP,data_rec_3$TEMP,data_rec_4$TEMP,data_rec_5$TEMP), na.rm = T)
  scatter_data[ii,7] = mean(c(data_rec_1$PREC,data_rec_2$PREC,data_rec_3$PREC,data_rec_4$PREC,data_rec_5$PREC), na.rm = T)
  scatter_data[ii,8] = mean(c(data_rec_1$EVAP,data_rec_2$EVAP,data_rec_3$EVAP,data_rec_4$EVAP,data_rec_5$EVAP), na.rm = T)
  
}

scatter_data = as.data.frame(scatter_data)
```

## Plots as in SISAL1k and Fohlmeister

# Altitude

Fohlmeister2020 see absence of low \dC in high altitude values. 
We only see, that for low latitudes, the \dC range is much larger than for high latitudes. However this may also be a sample bias, as most speleothems are found in lower latitudes

```{r}
plot(scatter_data$altitude, scatter_data$d13C, xlim = c(0,3500), ylim = c(-15,5), pch = 16, col = "black", xlab = "altitude in m", ylab = "d13C")
points(Fohlmeister$altitude..m.asl., Fohlmeister$d13C, pch = 18, col = "red")
mtext(text = "last century + obs.", side = 1, line = -2, adj = 0.9, col = "red")
mtext(text = "last mill + sim", side = 1, line = -3, adj = 0.9, col = "black")
```

# Precipitation

Fohlmeister2020 find a weak but significant relationship of \dC with precipitation - we cannot say that (mostly because of the few less depleted once). 
Also they find only depleted \dC in regions with more than 1500mm rain per year. NOT for us...
```{r}
plot(scatter_data$PREC, scatter_data$d13C, xlim = c(0,4000), ylim = c(-15,5), pch = 16, col = "black", xlab = "precip in mm/a", ylab = "d13C")
points(Fohlmeister$Precipi.tation..mm.a., Fohlmeister$d13C, pch = 18, col = "red")
mtext(text = "last century + obs.", side = 1, line = -2, adj = 0.9, col = "red")
mtext(text = "last mill + sim", side = 1, line = -3, adj = 0.9, col = "black")
```

# Temperature 

Fohlmeister2020 observe large spreads in \dC for MAT<5CC. This is also not all all true for us. This might be a sample bias and highlights the very local and maybe even cave-internal nature of \dC. 
Fohlmeister finds average speleothem \dC in cold areas to be higher than those in hot areas. Also here we cannot agree - we have a very large spread in \dC in the Tropics.

```{r}
plot(scatter_data$TEMP, scatter_data$d13C, xlim = c(0,30), ylim = c(-15,5), pch = 16, col = "black", xlab = "temp in °C", ylab = "d13C")
points(Fohlmeister$MAT...C., Fohlmeister$d13C, pch = 18, col = "red")
mtext(text = "last century + obs.", side = 1, line = -2, adj = 0.9, col = "red")
mtext(text = "last mill + sim", side = 1, line = -3, adj = 0.9, col = "black")
```